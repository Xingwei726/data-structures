{"filter":false,"title":"README.md","tooltip":"/week5/README.md","undoManager":{"mark":47,"position":47,"stack":[[{"start":{"row":0,"column":0},"end":{"row":57,"column":330},"action":"insert","lines":["## Assignment Description","Continue working with the data we've parsed, and augmented in the previous three assignments. In this assignment, we will write our AA data to a relational database.","","## Working Process","**Part One: Plan**","","- Normalized data may cause queries to slow down but I will use a normalized data model because data redundancy costs extra trouble in terms of maintaining the database, so in my plan each entity has its own table.","- When data come out of data base it will be organized in an JSON object structure. The hierarchy depends on users’ queries. If they want to search for groups, then groups’ info will be placed on top level with other foreign keys which give access to other data tables such as meetings ( all meetings this group has) and locations (all location associated with this group) etc.","","I chose the ER modeling language to create data model for AA meetings’ data because it’s universally used to represent relationships between different entities. I categorized data attributes into four entities (buckets) : location/group/meeting/time.","","![](AAERModeling.png)","","**Part Two: Create a table(s) in the database**","","Modify the starter code to create tables in my data base, since I don't have all necessary information parsed out yet, in `week04a`  I just replaced the database credentials with my own, hide key using .env file. ","```javascript","var db_credentials = new Object();","db_credentials.user = 'huanx429';","db_credentials.host = 'database-structures.c9iddlpctkv6.us-east-1.rds.amazonaws.com';","db_credentials.database = 'aa';","db_credentials.password = process.env.AWSRDS_PW;","db_credentials.port = 5432;","","// Connect to the AWS RDS Postgres database (not gonna change)","const client = new Client(db_credentials);","client.connect();","var thisQuery = \"CREATE TABLE aalocations (address varchar(100), lat double precision, long double precision);\";","```","  ","  ","**Part Three: Populate the database**","","Use the [pg module](https://node-postgres.com/) in Node to insert my AA data in the database I created. ","```Javascript","var rawAddresses = fs.readFileSync('../week4/first.json');","var addressesForDb = JSON.parse(rawAddresses);","","async.eachSeries(addressesForDb, function(value, callback) {","    const client = new Client(db_credentials);","    client.connect();","    var thisQuery = \"INSERT INTO aalocations VALUES (E'\" + value.address + \"', \" + value.lat + \", \" + value.lng + \");\";","    client.query(thisQuery, (err, res) => {","        console.log(err, res);","        client.end();","    });","    setTimeout(callback, 1000); ","}); ","```","  ","**Part Four: Check Database Table**","","Use the starter code to query all of the contents in my database right now to check.","![](CheckDatabase.jpg)","","## Conclusions:","","As I was planning the database model, I was wandering if I should put time information into its own table or not. Reason why I did this is because then user can search time / group / location and get meeting information related with each unique key. But I'm not sure creating this extra table would or would not complex the query?"],"id":1}],[{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"remove","lines":["Continue working with the data we've parsed, and augmented in the previous three assignments. In this assignment, we will write our AA data to a relational database.",""],"id":2},{"start":{"row":1,"column":0},"end":{"row":1,"column":96},"action":"insert","lines":["start to work with data for the \"Process Blog\" project (the data source for Final Assignment 2)."]}],[{"start":{"row":1,"column":96},"end":{"row":2,"column":0},"action":"insert","lines":["",""],"id":3}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":1},"action":"remove","lines":["s"],"id":4}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":1},"action":"insert","lines":["S"],"id":5}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":87},"action":"insert","lines":["use Amazon Web Services to create a table in Amazon DynamoDB, a NoSQL database service."],"id":6}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":1},"action":"remove","lines":["u"],"id":7}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":1},"action":"insert","lines":["U"],"id":8}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"remove","lines":["e"],"id":9}],[{"start":{"row":1,"column":2},"end":{"row":1,"column":3},"action":"insert","lines":["i"],"id":10},{"start":{"row":1,"column":3},"end":{"row":1,"column":4},"action":"insert","lines":["n"]},{"start":{"row":1,"column":4},"end":{"row":1,"column":5},"action":"insert","lines":["g"]}],[{"start":{"row":1,"column":88},"end":{"row":1,"column":89},"action":"remove","lines":["."],"id":11}],[{"start":{"row":1,"column":88},"end":{"row":1,"column":89},"action":"insert","lines":[" "],"id":12},{"start":{"row":1,"column":89},"end":{"row":1,"column":90},"action":"insert","lines":["a"]},{"start":{"row":1,"column":90},"end":{"row":1,"column":91},"action":"insert","lines":["n"]},{"start":{"row":1,"column":91},"end":{"row":1,"column":92},"action":"insert","lines":["d"]}],[{"start":{"row":1,"column":92},"end":{"row":1,"column":93},"action":"insert","lines":[" "],"id":13}],[{"start":{"row":1,"column":93},"end":{"row":1,"column":94},"action":"remove","lines":["S"],"id":14}],[{"start":{"row":1,"column":93},"end":{"row":1,"column":94},"action":"insert","lines":["s"],"id":15}],[{"start":{"row":6,"column":2},"end":{"row":8,"column":0},"action":"remove","lines":["Normalized data may cause queries to slow down but I will use a normalized data model because data redundancy costs extra trouble in terms of maintaining the database, so in my plan each entity has its own table.","- When data come out of data base it will be organized in an JSON object structure. The hierarchy depends on users’ queries. If they want to search for groups, then groups’ info will be placed on top level with other foreign keys which give access to other data tables such as meetings ( all meetings this group has) and locations (all location associated with this group) etc.",""],"id":16}],[{"start":{"row":6,"column":1},"end":{"row":6,"column":2},"action":"remove","lines":[" "],"id":17},{"start":{"row":6,"column":0},"end":{"row":6,"column":1},"action":"remove","lines":["-"]},{"start":{"row":5,"column":0},"end":{"row":6,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":5,"column":0},"end":{"row":6,"column":0},"action":"insert","lines":["",""],"id":18},{"start":{"row":6,"column":0},"end":{"row":6,"column":1},"action":"insert","lines":["-"]}],[{"start":{"row":6,"column":1},"end":{"row":6,"column":2},"action":"insert","lines":[" "],"id":19},{"start":{"row":6,"column":2},"end":{"row":6,"column":3},"action":"insert","lines":["f"]},{"start":{"row":6,"column":3},"end":{"row":6,"column":4},"action":"insert","lines":["o"]},{"start":{"row":6,"column":4},"end":{"row":6,"column":5},"action":"insert","lines":["r"]}],[{"start":{"row":6,"column":5},"end":{"row":6,"column":6},"action":"insert","lines":[" "],"id":20},{"start":{"row":6,"column":6},"end":{"row":6,"column":7},"action":"insert","lines":["t"]}],[{"start":{"row":6,"column":6},"end":{"row":6,"column":7},"action":"remove","lines":["t"],"id":21},{"start":{"row":6,"column":5},"end":{"row":6,"column":6},"action":"remove","lines":[" "]},{"start":{"row":6,"column":4},"end":{"row":6,"column":5},"action":"remove","lines":["r"]},{"start":{"row":6,"column":3},"end":{"row":6,"column":4},"action":"remove","lines":["o"]},{"start":{"row":6,"column":2},"end":{"row":6,"column":3},"action":"remove","lines":["f"]}],[{"start":{"row":6,"column":2},"end":{"row":6,"column":3},"action":"insert","lines":["F"],"id":22},{"start":{"row":6,"column":3},"end":{"row":6,"column":4},"action":"insert","lines":["o"]},{"start":{"row":6,"column":4},"end":{"row":6,"column":5},"action":"insert","lines":["r"]}],[{"start":{"row":6,"column":5},"end":{"row":6,"column":6},"action":"insert","lines":[" "],"id":23},{"start":{"row":6,"column":6},"end":{"row":6,"column":7},"action":"insert","lines":["t"]},{"start":{"row":6,"column":7},"end":{"row":6,"column":8},"action":"insert","lines":["h"]},{"start":{"row":6,"column":8},"end":{"row":6,"column":9},"action":"insert","lines":["i"]},{"start":{"row":6,"column":9},"end":{"row":6,"column":10},"action":"insert","lines":["s"]}],[{"start":{"row":6,"column":10},"end":{"row":6,"column":11},"action":"insert","lines":[" "],"id":24},{"start":{"row":6,"column":11},"end":{"row":7,"column":0},"action":"insert","lines":["",""]},{"start":{"row":7,"column":0},"end":{"row":7,"column":2},"action":"insert","lines":["- "]},{"start":{"row":7,"column":2},"end":{"row":8,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":9,"column":0},"end":{"row":10,"column":0},"action":"insert","lines":["",""],"id":25}],[{"start":{"row":6,"column":10},"end":{"row":6,"column":11},"action":"insert","lines":[" "],"id":26},{"start":{"row":6,"column":11},"end":{"row":6,"column":12},"action":"insert","lines":["p"]},{"start":{"row":6,"column":12},"end":{"row":6,"column":13},"action":"insert","lines":["r"]},{"start":{"row":6,"column":13},"end":{"row":6,"column":14},"action":"insert","lines":["o"]},{"start":{"row":6,"column":14},"end":{"row":6,"column":15},"action":"insert","lines":["j"]},{"start":{"row":6,"column":15},"end":{"row":6,"column":16},"action":"insert","lines":["e"]}],[{"start":{"row":6,"column":16},"end":{"row":6,"column":17},"action":"insert","lines":["c"],"id":27},{"start":{"row":6,"column":17},"end":{"row":6,"column":18},"action":"insert","lines":["t"]}],[{"start":{"row":6,"column":17},"end":{"row":6,"column":18},"action":"remove","lines":["t"],"id":28},{"start":{"row":6,"column":16},"end":{"row":6,"column":17},"action":"remove","lines":["c"]},{"start":{"row":6,"column":15},"end":{"row":6,"column":16},"action":"remove","lines":["e"]},{"start":{"row":6,"column":14},"end":{"row":6,"column":15},"action":"remove","lines":["j"]},{"start":{"row":6,"column":13},"end":{"row":6,"column":14},"action":"remove","lines":["o"]}],[{"start":{"row":6,"column":13},"end":{"row":6,"column":14},"action":"insert","lines":["o"],"id":29},{"start":{"row":6,"column":14},"end":{"row":6,"column":15},"action":"insert","lines":["j"]},{"start":{"row":6,"column":15},"end":{"row":6,"column":16},"action":"insert","lines":["e"]},{"start":{"row":6,"column":16},"end":{"row":6,"column":17},"action":"insert","lines":["c"]},{"start":{"row":6,"column":17},"end":{"row":6,"column":18},"action":"insert","lines":["t"]}],[{"start":{"row":6,"column":18},"end":{"row":6,"column":19},"action":"insert","lines":[" "],"id":30},{"start":{"row":6,"column":19},"end":{"row":6,"column":20},"action":"insert","lines":["I"]}],[{"start":{"row":6,"column":20},"end":{"row":6,"column":21},"action":"insert","lines":[" "],"id":31},{"start":{"row":6,"column":21},"end":{"row":6,"column":22},"action":"insert","lines":["c"]},{"start":{"row":6,"column":22},"end":{"row":6,"column":23},"action":"insert","lines":["h"]},{"start":{"row":6,"column":23},"end":{"row":6,"column":24},"action":"insert","lines":["o"]},{"start":{"row":6,"column":24},"end":{"row":6,"column":25},"action":"insert","lines":["o"]},{"start":{"row":6,"column":25},"end":{"row":6,"column":26},"action":"insert","lines":["s"]},{"start":{"row":6,"column":26},"end":{"row":6,"column":27},"action":"insert","lines":["e"]}],[{"start":{"row":6,"column":27},"end":{"row":6,"column":28},"action":"insert","lines":[" "],"id":32},{"start":{"row":6,"column":28},"end":{"row":6,"column":29},"action":"insert","lines":["t"]},{"start":{"row":6,"column":29},"end":{"row":6,"column":30},"action":"insert","lines":["o"]}],[{"start":{"row":6,"column":30},"end":{"row":6,"column":31},"action":"insert","lines":[" "],"id":33},{"start":{"row":6,"column":31},"end":{"row":6,"column":32},"action":"insert","lines":["u"]},{"start":{"row":6,"column":32},"end":{"row":6,"column":33},"action":"insert","lines":["s"]},{"start":{"row":6,"column":33},"end":{"row":6,"column":34},"action":"insert","lines":["e"]}],[{"start":{"row":6,"column":34},"end":{"row":6,"column":35},"action":"insert","lines":[" "],"id":34},{"start":{"row":6,"column":35},"end":{"row":6,"column":36},"action":"insert","lines":["d"]},{"start":{"row":6,"column":36},"end":{"row":6,"column":37},"action":"insert","lines":["e"]},{"start":{"row":6,"column":37},"end":{"row":6,"column":38},"action":"insert","lines":["n"]},{"start":{"row":6,"column":38},"end":{"row":6,"column":39},"action":"insert","lines":["o"]},{"start":{"row":6,"column":39},"end":{"row":6,"column":40},"action":"insert","lines":["r"]},{"start":{"row":6,"column":40},"end":{"row":6,"column":41},"action":"insert","lines":["m"]}],[{"start":{"row":6,"column":41},"end":{"row":6,"column":42},"action":"insert","lines":["a"],"id":35},{"start":{"row":6,"column":42},"end":{"row":6,"column":43},"action":"insert","lines":["l"]},{"start":{"row":6,"column":43},"end":{"row":6,"column":44},"action":"insert","lines":["i"]},{"start":{"row":6,"column":44},"end":{"row":6,"column":45},"action":"insert","lines":["z"]},{"start":{"row":6,"column":45},"end":{"row":6,"column":46},"action":"insert","lines":["a"]},{"start":{"row":6,"column":46},"end":{"row":6,"column":47},"action":"insert","lines":["e"]},{"start":{"row":6,"column":47},"end":{"row":6,"column":48},"action":"insert","lines":["d"]}],[{"start":{"row":6,"column":48},"end":{"row":6,"column":49},"action":"insert","lines":[" "],"id":36},{"start":{"row":6,"column":49},"end":{"row":6,"column":50},"action":"insert","lines":["d"]},{"start":{"row":6,"column":50},"end":{"row":6,"column":51},"action":"insert","lines":["a"]},{"start":{"row":6,"column":51},"end":{"row":6,"column":52},"action":"insert","lines":["t"]},{"start":{"row":6,"column":52},"end":{"row":6,"column":53},"action":"insert","lines":["a"]}],[{"start":{"row":0,"column":0},"end":{"row":58,"column":330},"action":"remove","lines":["## Assignment Description","Using Amazon Web Services to create a table in Amazon DynamoDB, a NoSQL database service and start to work with data for the \"Process Blog\" project (the data source for Final Assignment 2).","","## Working Process","**Part One: Plan**","","- For this project I choose to use denormalizaed data ","- ","","","I chose the ER modeling language to create data model for AA meetings’ data because it’s universally used to represent relationships between different entities. I categorized data attributes into four entities (buckets) : location/group/meeting/time.","","![](AAERModeling.png)","","**Part Two: Create a table(s) in the database**","","Modify the starter code to create tables in my data base, since I don't have all necessary information parsed out yet, in `week04a`  I just replaced the database credentials with my own, hide key using .env file. ","```javascript","var db_credentials = new Object();","db_credentials.user = 'huanx429';","db_credentials.host = 'database-structures.c9iddlpctkv6.us-east-1.rds.amazonaws.com';","db_credentials.database = 'aa';","db_credentials.password = process.env.AWSRDS_PW;","db_credentials.port = 5432;","","// Connect to the AWS RDS Postgres database (not gonna change)","const client = new Client(db_credentials);","client.connect();","var thisQuery = \"CREATE TABLE aalocations (address varchar(100), lat double precision, long double precision);\";","```","  ","  ","**Part Three: Populate the database**","","Use the [pg module](https://node-postgres.com/) in Node to insert my AA data in the database I created. ","```Javascript","var rawAddresses = fs.readFileSync('../week4/first.json');","var addressesForDb = JSON.parse(rawAddresses);","","async.eachSeries(addressesForDb, function(value, callback) {","    const client = new Client(db_credentials);","    client.connect();","    var thisQuery = \"INSERT INTO aalocations VALUES (E'\" + value.address + \"', \" + value.lat + \", \" + value.lng + \");\";","    client.query(thisQuery, (err, res) => {","        console.log(err, res);","        client.end();","    });","    setTimeout(callback, 1000); ","}); ","```","  ","**Part Four: Check Database Table**","","Use the starter code to query all of the contents in my database right now to check.","![](CheckDatabase.jpg)","","## Conclusions:","","As I was planning the database model, I was wandering if I should put time information into its own table or not. Reason why I did this is because then user can search time / group / location and get meeting information related with each unique key. But I'm not sure creating this extra table would or would not complex the query?"],"id":37}],[{"start":{"row":0,"column":0},"end":{"row":111,"column":260},"action":"insert","lines":["","## Assignment Description","Using Amazon Web Services to create a table in Amazon DynamoDB, a NoSQL database service and start to work with data for the \"Process Blog\" project (the data source for Final Assignment 2).","","","## Working Process","**Part One: Plan**","","- For this project I choose to use denormalized data because it's blog posts so redundancy doesn't matter in this case. ","- After I did some research, I decided to use **a composite partition-sort key** where I can hold the partition key element constant, and search across the sort key element to retrieve items. Such searching would allow me to use the Query API to, for example, retrieve all items for the same 'mood' across a range of time stamps.","- I designate the date types for each attribute based on this [Naming Rules & Data Types References](https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.NamingRulesDataTypes.html)","","![](ProcessBlog.png)","","","","**Part Two: Create some data for the table in your database**","","I referenced on the [DynamoDB class](https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB.html) for information about the [PutItem method](https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB.html#putItem-property) and data types.  The following starter code creates several \"Items\" destined for DynamoDB, storing them in an array named `blogEntries`:","**Partition Key** : mood  ","**Sort Key** : date _(Enrtry Date)_","","```javascript","var blogEntries = [];","","class BlogEntry {","  constructor(patitionKey, sortKey, author, title, content, cupofcoffee, eatchocolate, iate, sunsetphoto) {","    this.mood = {};","    this.mood.S = patitionKey;","    this.date = {}; ","    this.date.S = new Date(sortKey).toDateString();","    this.author = {};","    this.author.S = author;","    this.title = {};","    this.title.S = title;","    this.content = {};","    this.content.S = content;","    this.cupofcoffee = {};","    this.cupofcoffee.N = cupofcoffee.toString();","    this.eatchocolate = {};","    this.eatchocolate.BOOL = eatchocolate; ","    if (iate != null) {","      this.iate = {};","      this.iate.SS = iate; ","    }","    // if (sunsetphoto !=null){","    //   this.sunsetphoto ={};","    //   this.sunsetphoto = sunsetphoto;","    // }","  }","}","blogEntries.push(new BlogEntry('Whimsical','Sep 12 2019', \"Xingwei\", \"Just Another Peaceful Day\", \"Not much happened today, just made the plan for upcoming weekend.\", 1, true, [\"Poke\", \"Brownie\"]));","blogEntries.push(new BlogEntry('Calm','Sep 24 2019', \"Xingwei\", \"A bit Chill\", \"Feel like summer is drifting away, shopping temptation for sweaters rises\", 2,false, [\"Green Salads\", \"Meatballs\"]));","blogEntries.push(new BlogEntry('Calm','Aug 16 2019', \"Xingwei\", \"Homemade Cupcakes\", \"Learned a new recipe today, maybe I will give it a try tomorrow.\", 0, true, [\"Homemade Cupcakes\"]));","blogEntries.push(new BlogEntry('Lighthearted','Aug 28 2019', \"Xingwei\", \"Another Peaceful Day\", \"Wondering what will I be doing after 5 years.\", 1, false));","blogEntries.push(new BlogEntry('Tense','Sep 29 2019', \"Xingwei\", \"Ughh\", \"Forgot where I put the charging case for my toothbrush, its battery is down so I need to find it ASAP\", 0, true, [\"lasagna\", \"Squid\"]));","```","  ","  ","**Part Three: Populate the database**","","Use the AWS SDK for JavaScript to work with my DynamoDB table in Node.js. Install with:  `npm install aws-sdk`","I modified the starter code so I can loop over all of the items in my array and put  multiple items into my table at the same time.","","```Javascript","var AWS = require('aws-sdk');","AWS.config = new AWS.Config();","AWS.config.region = \"us-east-1\";","","var dynamodb = new AWS.DynamoDB();","var tableName = \"processblog\";","putItems(blogEntries)",".then(() => {","    return putItems(blogEntries);","})",".catch((err) => {","    console.error('Insert failed', err);","});","","function putItems(items){","    var insertedCount = 0;","    return new Promise ((resolve, reject) =>{","        items.forEach(item =>{","            var params ={","              TableName: tableName,","              Item: item","            };","            ","            dynamodb.putItem(params, (err,data) =>{","                if(err){","                    reject(err);","                }","                else{","                    if(++insertedCount ==items.length){","                        console.log('Successfully inserted'+items.length + 'items.');","                        resolve();","                    }","                }","            });","        });","    });","}","```","  ","**Part Four: Check Database Table**","Checked my table in the AWS Console and make sure my items were successfully put into the table. (PS: When I loop over all items in the last step, if it was successful I would see a message in my console as well to double make sure.)","","![](CheckDatabase.jpg)","","## Conclusions:","","In my data model plan I was wondering if it was possible to put images into DynamoDB tables, I searched online and people say I could have an IMAGES table where you store items with an image Binary attribute value, however I don't know how to achieve that yet."],"id":38}],[{"start":{"row":107,"column":22},"end":{"row":108,"column":0},"action":"insert","lines":["",""],"id":39}],[{"start":{"row":108,"column":0},"end":{"row":108,"column":1},"action":"insert","lines":["!"],"id":40}],[{"start":{"row":108,"column":1},"end":{"row":108,"column":3},"action":"insert","lines":["[]"],"id":41}],[{"start":{"row":108,"column":3},"end":{"row":108,"column":5},"action":"insert","lines":["()"],"id":42}],[{"start":{"row":108,"column":4},"end":{"row":108,"column":20},"action":"insert","lines":["ConsoleCheck.jpg"],"id":43}],[{"start":{"row":105,"column":97},"end":{"row":105,"column":233},"action":"remove","lines":["(PS: When I loop over all items in the last step, if it was successful I would see a message in my console as well to double make sure.)"],"id":44},{"start":{"row":105,"column":96},"end":{"row":105,"column":97},"action":"remove","lines":[" "]}],[{"start":{"row":107,"column":22},"end":{"row":108,"column":0},"action":"insert","lines":["",""],"id":45}],[{"start":{"row":108,"column":0},"end":{"row":108,"column":136},"action":"insert","lines":["(PS: When I loop over all items in the last step, if it was successful I would see a message in my console as well to double make sure.)"],"id":46}],[{"start":{"row":108,"column":136},"end":{"row":109,"column":0},"action":"insert","lines":["",""],"id":47}],[{"start":{"row":107,"column":22},"end":{"row":108,"column":0},"action":"insert","lines":["",""],"id":48}]]},"ace":{"folds":[],"scrolltop":112,"scrollleft":0,"selection":{"start":{"row":16,"column":61},"end":{"row":16,"column":61},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":18,"state":"start","mode":"ace/mode/markdown"}},"timestamp":1569792020392,"hash":"6ebb0a7b2ac3a6d5ef57e5c77f2fc1aa7a13bfc4"}